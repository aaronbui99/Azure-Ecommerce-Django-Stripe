{% extends 'base.html' %}
{% load static %}

{% block title %}My Profile - {{ block.super }}{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row">
        <div class="col-md-3 mb-4">
            <!-- Profile Sidebar -->
            <div class="card">
                <div class="card-body text-center">
                    {% if user.profile.avatar %}
                        <img src="{{ user.profile.avatar.url }}" alt="Profile Picture" 
                             class="rounded-circle mb-3" width="100" height="100" style="object-fit: cover;">
                    {% else %}
                        <div class="bg-secondary rounded-circle d-inline-flex align-items-center justify-content-center mb-3" 
                             style="width: 100px; height: 100px;">
                            <i class="fas fa-user fa-3x text-white"></i>
                        </div>
                    {% endif %}
                    <h5>{{ user.get_full_name|default:user.username }}</h5>
                    <p class="text-muted">{{ user.email }}</p>
                    <a href="{% url 'accounts:profile_edit' %}" class="btn btn-primary btn-sm">Edit Profile</a>
                </div>
            </div>

            <!-- Navigation Menu -->
            <div class="list-group mt-3">
                <a href="{% url 'accounts:profile' %}" class="list-group-item list-group-item-action active">
                    <i class="fas fa-user me-2"></i>Profile
                </a>
                <a href="{% url 'orders:list' %}" class="list-group-item list-group-item-action">
                    <i class="fas fa-shopping-bag me-2"></i>Order History
                </a>
                <a href="{% url 'payments:methods' %}" class="list-group-item list-group-item-action">
                    <i class="fas fa-credit-card me-2"></i>Payment Methods
                </a>
                <a href="{% url 'accounts:logout' %}" class="list-group-item list-group-item-action text-danger">
                    <i class="fas fa-sign-out-alt me-2"></i>Logout
                </a>
            </div>
        </div>

        <div class="col-md-9">
            <!-- Profile Information -->
            <div class="card">
                <div class="card-header">
                    <h4 class="mb-0">Profile Information</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">First Name</label>
                            <p class="fw-bold">{{ user.first_name|default:"Not provided" }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Last Name</label>
                            <p class="fw-bold">{{ user.last_name|default:"Not provided" }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Email Address</label>
                            <p class="fw-bold">{{ user.email }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Phone Number</label>
                            <p class="fw-bold">{{ user.phone|default:"Not provided" }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Username</label>
                            <p class="fw-bold">{{ user.username }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Member Since</label>
                            <p class="fw-bold">{{ user.date_joined|date:"M j, Y" }}</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Address Information -->
            <div class="card mt-4">
                <div class="card-header">
                    <h4 class="mb-0">Address Information</h4>
                </div>
                <div class="card-body">
                    {% if user.street_address or user.city or user.state or user.postal_code or user.country %}
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <label class="form-label text-muted">Street Address</label>
                            <p class="fw-bold">{{ user.street_address|default:"Not provided" }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">City</label>
                            <p class="fw-bold">{{ user.city|default:"Not provided" }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">State</label>
                            <p class="fw-bold">{{ user.state|default:"Not provided" }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Postal Code</label>
                            <p class="fw-bold">{{ user.postal_code|default:"Not provided" }}</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted">Country</label>
                            <p class="fw-bold">{{ user.country|default:"Not provided" }}</p>
                        </div>
                    </div>
                    {% else %}
                    <div class="text-center py-4">
                        <p class="text-muted mb-3">No address information provided</p>
                        <a href="{% url 'accounts:profile_edit' %}" class="btn btn-outline-primary">Add Address</a>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Profile Settings -->
            {% if user.profile %}
            <div class="card mt-4">
                <div class="card-header">
                    <h4 class="mb-0">Profile Settings</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <label class="form-label text-muted">Bio</label>
                            <p class="fw-bold">{{ user.profile.bio|default:"No bio provided" }}</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" disabled 
                                       {% if user.profile.newsletter_subscription %}checked{% endif %}>
                                <label class="form-check-label text-muted">Newsletter Subscription</label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" disabled 
                                       {% if user.profile.marketing_emails %}checked{% endif %}>
                                <label class="form-check-label text-muted">Marketing Emails</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
{% endblock %}